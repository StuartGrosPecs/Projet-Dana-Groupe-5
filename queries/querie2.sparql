PREFIX dbo:  <http://dbpedia.org/ontology/>
PREFIX ex:   <http://example.com/>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX xsd:  <http://www.w3.org/2001/XMLSchema#>

SELECT ?clubName
       (COUNT(?player) AS ?nbPlayers)
       (SUM(xsd:integer(?goals)) AS ?totalGoals)
       (AVG(xsd:integer(?goals)) AS ?avgGoals)
       (SUM(xsd:integer(?assists)) AS ?totalAssists)
       (AVG(xsd:integer(?assists)) AS ?avgAssists)
WHERE {
    ?player ex:goals   ?goals ;
            ex:assists ?assists ;
            dbo:team   ?club .

    ?club foaf:name ?clubName .
}
GROUP BY ?clubName
ORDER BY DESC(?totalGoals)
LIMIT 10
